<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Slides_flash.knit</title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs-2.21/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <link href="libs/panelset-0.2.6/panelset.css" rel="stylesheet" />
    <script src="libs/panelset-0.2.6/panelset.js"></script>
    <link href="libs/tile-view-0.2.6/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view-0.2.6/tile-view.js"></script>
    <script src="libs/xaringanExtra-progressBar-0.0.1/progress-bar.js"></script>
    <script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.28/datatables.js"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
  </head>
  <body>
    <textarea id="source">

class: center, inverse





<style>.xe__progress-bar__container {
  top:0;
  opacity: 1;
  position:absolute;
  right:0;
  left: 0;
}
.xe__progress-bar {
  height: 0.25em;
  background-color: #808080;
  width: calc(var(--slide-current) / var(--slide-total) * 100%);
}
.remark-visible .xe__progress-bar {
  animation: xe__progress-bar__wipe 200ms forwards;
  animation-timing-function: cubic-bezier(.86,0,.07,1);
}
@keyframes xe__progress-bar__wipe {
  0% { width: calc(var(--slide-previous) / var(--slide-total) * 100%); }
  100% { width: calc(var(--slide-current) / var(--slide-total) * 100%); }
}</style>

&lt;style type="text/css"&gt;
.pull-left {
  float: left;
  width: 48%;
}
.pull-right {
  float: right;
  width: 48%;
}
.pull-right ~ p {
  clear: both;
}

.pull-left-wide {
  float: left;
  width: 66%;
}
.pull-right-wide {
  float: right;
  width: 66%;
}
.pull-right-wide ~ p {
  clear: both;
}

.pull-left-narrow {
  float: left;
  width: 30%;
}
.pull-right-narrow {
  float: right;
  width: 30%;
}

.tiny123 {
  font-size: 0.40em;
}

.small123 {
  font-size: 0.80em;
}

.large123 {
  font-size: 2em;
}

.huge123 {
  font-size: 4em;
}

.red {
  color: red;
}

.highlight {
  background-color: yellow;
}
&lt;/style&gt;



# Breaking the HISCO Barrier: 
## *AI and Occupational Data Standardization*
### Christian Møller-Dahl
### Torben S. D. Johansen
### Christian Vedel
### University of Southern Denmark, HEDG

#### Updated 2024-04-05 

---
class: middle, Large
.pull-left[
# What
- New tool to make research using historical occupations easier
- Language model, OccCANINE:
  + **Input:** "En" + "He is a farmer"
  + **Output:** HISCO code 61110 (probability=0.989589)
  
- Everything is free, open source, wrapped up in a simple python library and available at [github.com/christianvedels/OccCANINE](https://github.com/christianvedels/OccCANINE)

]

---
# Team

.pull-left[
&lt;img src="https://portal.findresearcher.sdu.dk/files-asset/200947586/1b5a4dd1-bfba-4b37-a685-854958b1dd4e.jpg?w=160&amp;f=webp" width="150" /&gt;

Christian Møller Dahl, Professor


&lt;img src="https://portal.findresearcher.sdu.dk/files-asset/234467387/4353be14-7b5e-4a74-949c-144e6478a7da.jpg?w=160&amp;f=webp" width="150" /&gt;

Christian Vedel, Assistant Professor

]

.pull-right[
&lt;img src="https://media.licdn.com/dms/image/C4D03AQHyT9bJKlGKiA/profile-displayphoto-shrink_800_800/0/1581022934019?e=1716422400&amp;v=beta&amp;t=M00riaQqwb3DTRb_KD80_B1-POZINjpYq2VexqQ_kpE" width="150" /&gt;

Torben S. D. Johansen, Assistant Professor

*All at the university of Southern Denmark, Department of Economics*
]


---
# Data - thanks to...
.pull-left[
.tiny123[
| Shorthand name   | Language | Source                                                    |
|------------------|----------|-----------------------------------------------------------|
| DK_census        | da       | Clausen (2015); The Danish National Archives              |
| EN_marr_cert     | en       | G. Clark et al. (2022)                                    |
| EN_uk_ipums      | en       | MPS (2020); Office of National Statistics                 |
| SE_swedpop       | se       | SwedPop Team (2022)                                       |
| JIW_database     | nl       | Moor and van Weeren (“2021”)                              |
| EN_ca_ipums      | unk      | MPS (2020); Statistics Canada                             |
| CA_bcn           | ca       | Pujades Mora and Valls (2017)                             |
| HISCO_website    | mult     | HISCO database (2023)                                     |
| HSN_database     | nl       | Mandemakers et al (2020)                                  |
| NO_ipums         | no       | MPS (2020)                                                |
| FR_desc          | fr       | HISCO database (2023)                                     |
| EN_us_ipums      | en       | MPS (2020); Bureau of the Census                          |
| EN_parish        | en       | de Pleijt Nuvolari and Weisdorf (2019)                    |
| DK_cedar         | da       | Ford (2023)                                               |
| SE_cedar         | se       | Edvinsson and Westberg (2016)                             |
| DK_orsted        | da       | Ford (2023)                                               |
| EN_oclack        | en       | Zijdeman (2023)                                           |
| EN_loc           | en       | Mooney (2016)                                             |
| IS_ipums         | is       | MPS (2020)                                                |
| SE_chalmers      | se       | Ford (2023)                                               |
| DE_ipums         | ge       | MPS (2020); German Federal Statistical Office             |
| IT_fm            | it       | Fornasin and Marzona (2016)                               |

]
]

---
# Data examples



<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e09d93764827f4b1b643" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e09d93764827f4b1b643">{"x":{"filter":"none","vertical":false,"fillContainer":false,"data":[["1","2","3","4","5","6","7","8"],["major general, rha, retired","porter and labour master","higher executive officer, department of industry","yeoman and relieving officer","private machine gun corps","sub-contractor on the railway","clerk in holy orders, chaplain to the hon. east india company","decorator and contractor"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Raw entry<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---
class: middle
.pull-left[
# The old solution
- Spend weeks, months or years manually reading and categorising 

- 17865 different occupational descriptions fit with "farm servant" in DK censuses ("in service", "servant girl", "servant boy", "servant woman", "servant karl") 

- Spelling mistakes, negations, and different spelling conventions
]

.pull-right[
# Our solution
![Arhcitecture](Figures/Architecture_small.png)
.center[
### OccCANINE
.red[
~10k HISCO codes in 27 seconds  
~100k HISCO codes in 5 min.  
~1 million HISCO codes in 45 min.  
`\(\rightarrow\)` **All with high precision and recall**
]

]

]

---
class: middle
# Test data performance
.pull-left-narrow[
| Statistic | Lang. info. | Value |
|-----------|-------------|-------|
| Accuracy  | Yes         | 0.935 |
| F1 score  | Yes         | 0.960 |
| Precision | Yes         | 0.955 |
| Recall    | Yes         | 0.987 |
]

.footnote[
.small123[
*Based on 1 million test observations*
]
]

---
class: middle
# Multilingual performance

.pull-left[
&lt;img src="Figures/Performance_by_language.png" width="450" /&gt;
]



---
class: middle

# Out of Distribution
.pull-left[
| Dataset                    | N checked | Accuracy |
|----------------------------|-----------|----------|
| Copenhagen Burial Records  | 200       | 0.950    |
| Training Ship Data         | 200       | 0.985    |
| Swedish Strikes            | 200       | 0.945    |
| Dutch Familiegeld*         | 200       | 0.925    |

.footnote[
.small123[
`\(^*\)` *Thanks to Bram Hilkens*  
See more details in the paper
]
]

]


---
class: middle
# Read more

### [https://arxiv.org/abs/2402.13604](https://arxiv.org/abs/2402.13604)

.pull-right-narrow[
![Abstract](Figures/Paper.png)
]
















    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
.logo {
  background-image: url(Logos.png);
  background-size: contain;
  background-repeat: no-repeat;
  position: absolute;
  top: 1em;
  right: 1em;
  width: 83px;
  height: 96px;
  z-index: 0;
}
</style>

<script>
document
  .querySelectorAll(
    '.remark-slide-content' +
    ':not(.title-slide)' +
    // insert more to hide here
    ':not(.inverse)' +
    ':not(.hide-logo)'
  )
  .forEach(el => {
    el.innerHTML += '<div class="logo"></div>';
  });
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
